20230717 Machine Learning Project* Deep Learing (Keras)1) 주제선정, 기획  - 주제   기상데이터를 활용한 발전량 예측    - Dataframe shape, indep-var, dep-var   Total Valiable   -> 온도, 습도, 전운량, 일사량, 강수량, 적설량, 일조시간, 발전량   Independent Valiable   -> 온도, 습도, 전운량, 일사량, 강수량, 적설량, 일조시간   Dependent Valiable   -> 발전량  - 예측모델 선정 (sklearn / keras)   1) sklearn LinearRegression 사용   -> 온도, 습도, 전운량, 일사량, 일조시간, 강수량, 적설량, 일조시간으로부터       발전량 값을 예측하는 회귀 모델   2) keras DNN 사용       시계열 요소를 반영하지 않고 위 Dependent Valiable을 활용한       발전량 예측 신경망 모델       * 특정 일사량 값들이 주어졌을 때 설비용량별 발전량 예측   3) keras RNN, LSTM       시간대별 Dependent Valiable의 변화를 통한 발전량 예측 신경망 모델       * 이전 기상 데이터 값들을 통한 미래 발전량 예측--------------------------------------------------------------------------------- by keras.io 참고 사이트 (multivariate_data) https://ahnjg.tistory.com/33 https://codetorial.net/tensorflow/time_series_forecasting/forecast_a_multivariate_time_series.html https://www.kaggle.com/code/nicapotato/keras-timeseries-multi-step-multi-output----------------------------------------------------------------------------------* 데이터 수집/정제 - EDA(기초통계), 결측치 / 오류 수정, Normalization / Standardization * 발전량 데이터 불러오기  - 사내 서버 원격 접속 및 쿼리 적용   사용 모듈 : pymysql   접속 정보 : .env  - "서이 태양광 발전소"   설비용량 : 49.8kW   주소 : 경상남도 밀양시 초동면 금포리 343   rtu_id = 24   인버터 1대     - csv 파일로 저장  - 데이터 가공 필요 요소   * 누적발전량 -> 시간대별 발전량 변환  - 1단계. 전일 최대 누적 발전량 column 추가  - 2단계. 금일 누적 발전량 - 전일 최대 누적 발전량 column 추가  - 3단계. 현재 시간대 누적 발전량 기준 - 전 시간대 누적 발전량  - 통신 실패 영역 제외 상태   -> 기상 데이터 기준으로 Join   -> fillna 적용 0.00 채우기 * 기상 데이터 추가 로드  - ASOS에서 밀양시 데이터 가져오기----------------------------------------------------------------------------------1. 결과물 작성  - 어떤 프로젝트를 진행하였는가?   * 프로젝트 선정 이유   * 효용성(Domain Knowledge)   * 데이터 : 출처, EDA 내용   * 모델 : 모델 구성 / 선택의 이유   * 학습 결과 : 정확도, parameter 갯수, 시간 (학습/예측)   * 종합    - 새롭게 알 수 있었던 것    - 미래 가능성 : 양질의 데이터, 충분한 시간, 전용 하드웨어 사용 등* 내용 정의 1. 개요   * 주제 선정    최종 목표 : 기상 데이터를 활용한 발전량 예측 모델 개발   선정 배경   최근 신재생에너지 발전량 예측 기반 통합 관제 시스템 구축 사업에 대한 검토가 이루어지고 있음.   또한, ’20년부터 신재생에너지 발전량 예측에 대한 정부 지원 사업이 활성화되기 시작함.   선정 사유   기존 발전소 모니터링 서비스에 발전량 예측 서비스를 접목시켜 고객 수익성 확대 방안 검토를 위함   목적 : 신규 사업 아이템 발굴  * 발전량 모니터링 개요  * 발전량 예측 설명  * 태양광 발전 원리(기상 데이터 - 발전량 관계)  * 용어 정리 2. EDA   (데이터 수집 및 목표 데이터프레임 설정)  * 출처  - gsrems.co.kr (서이 태양광 발전소(밀양))    유효 데이터 : 2021~2022년 데이터  - ASOS 관측 기상 데이터((밀양))  * 데이터 수집  1) gsrems db에서 데이터 가져오기    python에서 제공하는 dotenv, pymysql 활용 데이터 가져오기    쿼리 적용 후 pickle 파일로 저장    테이블 : 누적발전량, 날짜, 시간  2) ASOS 관측 기상 데이터 csv 파일로 다운로드    read_csv + 날짜, 시간 조정  * 목표 데이터프레임 설정  각종 기상 데이터 + 시간대별 발전량(금일발전량) 구성  * 데이터 전처리 과정  1) 시간대별 발전량 산출    (1) 금일누적발전량 산출      누적발전량 - 전일최대누적발전량    (2) 시간대별 발전량(금일발전량) 산출      시간으로 groupby 한 후 해당 시간대의 최대값을 데이터프레임으로 생성      해당 시간 금일누적발전량 - 이전 시간 금일누적발전량  2) 일조시간과 발전량 시간 경계값 조정      일조시간 쉬프트 -1 3. 시계열 데이터 예측 모델 개발  * 다변량 시계열 데이터 관련 설명  * 다변량 시계열 데이터 예측   -> Feature_Label 구분 함수 설명   -> tensorflow Dataset에 대한 설명 (함수로 설명)   -> prefetch에 대한 설명   -> shuffle 적용/미적용 train_data_set 설명  * 단계적 모델 구성    1단계. window 사이즈, 배치 사이즈 조정      동일한 모델을 기준으로 window, batch 사이즈 변경 및 테스트    2단계. 모델별 성능 테스트      lstm, rnn, gru 모델 적용    3단계. 파라미터 조정 및 테스트      layer, neuron 수 조절      loss function 변경 테스트      activation function 변경 테스트      dropout 적용/미적용      learning_rate 조절 테스트    4단계. Feature 항목 변경 및 테스트 진행  * 학습 결과 비교(mse, mae) 및 최적의 모델 선정    lstm, rnn, gru 모델     -> mse, mae 비교    Feature 구성별      -> mse, mae 비교    실 적용 결과(차트) 4. 발전량 예측 적용 예시   * 아이디어     예보데이터 API -> 데이터셋 가공 및 DB 저장 -> 최신 데이터 27개 가져오기      -> 0시 ~ 23시 (24개 예측 데이터 생성)     (예보데이터 갱신 주기에 맞춰 최신화)   * 테스트 적용     예보데이터 DB -> 샘플데이터 CSV로 대체     예측 날짜 지정 시 샘플데이터에서 27시간치 기상 데이터 가져오기     -> 모델 적용 및 해당 날짜 0시 ~ 23시 예측 데이터 생성    5. 고찰  * 데이터적 한계   밀양시 "일사량" 데이터 누락    발전소 1개로 국한된 영역   설비용량 미적용     * 개선 사항   위도, 경도 기반 정확한 기상데이터 적용   "일사량" 데이터 확보를 통한 성능 개선   다양한 발전소 적용   설비용량 적용